@page
@model VSMS.Web.Pages.Admin.Calendar.PublishModel
@{
    ViewData["Title"] = "Publish Month";
    Layout = "_AdminLayout";
}

<h2>Publish @Model.MonthYear</h2>

@if (Model.AlreadyPublished)
{
    <div class="alert alert-info">
        This month has already been published on @Model.PublishedAt?.ToString("MMM d, yyyy").
    </div>
    <a href="/admin/calendar?month=@Model.Month&year=@Model.Year" class="btn btn-secondary">Back to Calendar</a>
}
else
{
    <p>Publishing will:</p>
    <ul>
        <li>Mark all shifts as published</li>
        <li>Send assignment emails to volunteers with their shifts</li>
        <li>Sync shifts to Google Calendar (if configured)</li>
    </ul>

    <div class="card mb-4">
        <div class="card-header">Summary</div>
        <div class="card-body">
            <p><strong>Total shifts:</strong> @Model.TotalShifts</p>
            <p><strong>Assigned shifts:</strong> @Model.AssignedShifts</p>
            <p><strong>Open shifts:</strong> @Model.OpenShifts</p>
            <p><strong>Volunteers to notify:</strong> @Model.VolunteersToNotify</p>
        </div>
    </div>

    @if (Model.OpenShifts > 0)
    {
        <div class="alert alert-warning">
            <strong>Warning:</strong> There are @Model.OpenShifts open shifts. You may want to fill these before publishing.
        </div>
    }

    <form method="post">
        <input type="hidden" name="month" value="@Model.Month" />
        <input type="hidden" name="year" value="@Model.Year" />
        <button type="submit" class="btn btn-success">Publish Month</button>
        <a href="/admin/calendar?month=@Model.Month&year=@Model.Year" class="btn btn-outline-secondary">Cancel</a>
    </form>
}
